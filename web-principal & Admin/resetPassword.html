<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إعادة تعيين كلمة المرور</title>
    <link href="register.css" rel="stylesheet" >

</head>
<body>
    <div class="center">
      <a class="navbar-brand navbar-logo sideLogo" href="#"><img src="navbarlogo.png" alt="logo" height="66"></a>
        <h1 class=""> إعادة تعيين كلمة المرور</h1>
        <form id="reset">
         
            
        

        <div class="inputbox">
            
            
            <input type="email" required="required"  id="emailInp">
            <span>البريد الإلكتروني</span>
            
          </div>
          <div id = 'alertContainer'>
          <h4 style="color: rgb(157, 48, 48); margin-right: 10%;"> يرجى إدخال البريد الإلكتروني المسجل في النظام -</h4>
          </div>
          <div class="inputbox">
            <button type="text" id="subButton" class="btn"  >  إرسال</button>
          </div>
    </form>
        
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
        import { getAuth, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-firestore.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-analytics.js";
        
        const firebaseConfig = {
             apiKey: "AIzaSyAk1XvudFS302cnbhPpnIka94st5nA23ZE",
             authDomain: "halaqa-89b43.firebaseapp.com",
             projectId: "halaqa-89b43",
             storageBucket: "halaqa-89b43.appspot.com",
             messagingSenderId: "969971486820",
             appId: "1:969971486820:web:40cc0abf19a909cc470f71",
             measurementId: "G-PCYTHJF1SD"
        };
           const app = initializeApp(firebaseConfig);
           const analytics = getAnalytics(app);

           var Email=document.getElementById("emailInp");
           Email = Email.value.toLowerCase();
           const submit=document.getElementById("subButton");
           const resetForm=document.getElementById("reset");

           const auth = getAuth();
           submit.addEventListener('click',  async (e) => {
            
         e.preventDefault()
         sendPasswordResetEmail(auth, Email.value)
         .then(() => {

           document.getElementById('alertContainer').innerHTML = '<div style="width: 500px; margin: 0 auto;"> <div class="alert success">  <input type="checkbox" id="alert2"/> <label class="close" title="close" for="alert2"> <i class="icon-remove"></i>  </label>  <p class="inner">تم إرسال بريد إلكتروني لإعادة تعيين كلمة المرور </p> </div>';
              setTimeout(() => {
              
                // 👇️ replace element from DOM
                document.getElementById('alertContainer').innerHTML = '<h4 style="color: rgb(157, 48, 48); margin-right: 10%;"> يرجى إدخال البريد الإلكتروني المسجل في النظام -</h4>';
          
              }, 6000);
           resetForm.reset();
           window.location.href= "index.html";

          })
          .catch((error) => {
             if(error.message=="Firebase: Error (auth/user-not-found)."){
              
           document.getElementById('alertContainer').innerHTML = '<div style="width: 500px; margin: 0 auto;"> <div class="alert error">  <input type="checkbox" id="alert1"/> <label class="close" title="close" for="alert1"> <i class="icon-remove"></i>  </label>  <p class="inner"> البريد الإلكتروني المدخل غير مسجل في النظام</p> </div>';
              setTimeout(() => {
              
                // 👇️ replace element from DOM
                document.getElementById('alertContainer').innerHTML = '<h4 style="color: rgb(157, 48, 48); margin-right: 10%;"> يرجى إدخال البريد الإلكتروني المسجل في النظام -</h4>';
          
              }, 6000);
             }
             else if (error.message=="Firebase: Error (auth/invalid-email)."){

              document.getElementById('alertContainer').innerHTML = '<div style="width: 500px; margin: 0 auto;"> <div class="alert error">  <input type="checkbox" id="alert1"/> <label class="close" title="close" for="alert1"> <i class="icon-remove"></i>  </label>  <p class="inner">يرجى التحقق من كتابة البريد الإلكتروني</p> </div>';
              setTimeout(() => {
              
                // 👇️ replace element from DOM
                document.getElementById('alertContainer').innerHTML = '<h4 style="color: rgb(157, 48, 48); margin-right: 10%;"> يرجى إدخال البريد الإلكتروني المسجل في النظام -</h4>';
          
              }, 6000);
             }
             else{
              console.log(error.message);
              
              document.getElementById('alertContainer').innerHTML = '<div style="width: 500px; margin: 0 auto;"> <div class="alert error">  <input type="checkbox" id="alert1"/> <label class="close" title="close" for="alert1"> <i class="icon-remove"></i>  </label>  <p class="inner">حدث خطأ يرجى المحاولة في وقت لاحق</p> </div>';
              setTimeout(() => {
              
                // 👇️ replace element from DOM
                document.getElementById('alertContainer').innerHTML = '<h4 style="color: rgb(157, 48, 48); margin-right: 10%;"> يرجى إدخال البريد الإلكتروني المسجل في النظام -</h4>';
          
              }, 6000);

             }

             const errorCode = error.code;
             const errorMessage = error.message;
             
       });
    });
    


    </script>

<div class="screen__background">
  <span class="screen__background__shape screen__background__shape5"></span>
  <span class="screen__background__shape screen__background__shape4"></span>
  <span class="screen__background__shape screen__background__shape3"></span>		
  <span class="screen__background__shape screen__background__shape2"></span>
  <span class="screen__background__shape screen__background__shape1"></span>
</div>
    
</body>
</html>